{% extends "base.html" %}

{% block content %}
<h1>All Grades</h1>

<input type="text" id="searchInput" placeholder="Search grades...">

<p>
    <a href="{{ url_for('add_grade') }}">‚ûï Add Grade</a>
</p>

{% if grades %}
<table id="gradesTable" border="1" cellpadding="5" cellspacing="0">
    <thead>
        <tr>
            <th>Student</th>
            <th>Course</th>
            <th>Semester</th>
            <th>Year</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for g in grades %}
        <tr>
            <td>{{ g.student_obj.first_name }} {{ g.student_obj.last_name }}</td>
            <td>{{ g.course_obj.course_name }}</td>
            <td>{{ g.semester }}</td>
            <td>{{ g.year }}</td>
            <td>
                <form action="{{ url_for('delete_grade', grade_id=g.id) }}" method="post" style="display:inline;">
                    <button type="submit">Delete</button>
                </form>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>No grades recorded yet.</p>
{% endif %}

<p>
    <a href="{{ url_for('home') }}">üè† Back to Home</a>
</p>

<script>
const searchInput = document.getElementById('searchInput');
const table = document.getElementById('gradesTable');
if (table) {
    const rows = Array.from(table.getElementsByTagName('tr')).slice(1); // skip header
    searchInput.addEventListener('input', function() {
        const filter = searchInput.value.toLowerCase();
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(filter) ? '' : 'none';
        });
    });
}
</script>

{% endblock %}
